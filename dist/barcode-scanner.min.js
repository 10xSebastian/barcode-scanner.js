(function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};t=function(){function t(){this.submit=e(this.submit,this),this.keyPress=e(this.keyPress,this),this.getArguments=e(this.getArguments,this),this.getAction=e(this.getAction,this),this.execute=e(this.execute,this),this.addAction=e(this.addAction,this),this.addChar=e(this.addChar,this),this.actions=[],this.buffer=null,this.delay=50,this.timer=null}return t.prototype.addChar=function(t){var e,i=this;return null==(e=this.buffer)&&(this.buffer=""),this.buffer+=t,window.clearTimeout(this.timer),this.timer=window.setTimeout(function(){return i.buffer=null},this.delay)},t.prototype.addAction=function(t,e){var i;return t="^"+t.replace(/\(.*?\)/gi,"(\\S*)")+"$",i=new RegExp(t),this.actions.push({regexp:i,callback:e})},t.prototype.execute=function(){var t,e,i,n;return e=$(document.activeElement),n=e.is("input, textarea")?e:$("[data-barcode-scanner-target]:last"),i=this.buffer,t=this.getAction(i),null!=t?t.callback.apply(n,this.getArguments(i,t)):(n.val("").val(i).focus(),this.submit(n)),this.buffer=null},t.prototype.getAction=function(t){var e,i,n,r;for(r=this.actions,i=0,n=r.length;n>i;i++)if(e=r[i],e.regexp.test(t))return e},t.prototype.getArguments=function(t,e){var i;return i=e.regexp.exec(t),i.slice(1,i.length+1||9e9)},t.prototype.keyPress=function(t){var e,i;return null==t&&(t=window.event),i="number"==typeof t.which?t.which:t.keyCode,e=String.fromCharCode(i),13===i&&null!=this.buffer?(t.preventDefault(),this.execute()):this.addChar(e)},t.prototype.submit=function(t){return t.closest("[data-prevent-barcode-scanner-submit]").length?void 0:t.closest("form").submit()},t}(),window.BarcodeScanner=new t,$(window).keypress(window.BarcodeScanner.keyPress)}).call(this);
